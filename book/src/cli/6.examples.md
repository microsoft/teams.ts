# Examples

This page provides practical examples of common usage patterns for the Teams CLI (`@microsoft/teams.cli`). These examples demonstrate how to use the CLI effectively for various scenarios.

## Basic Examples

### Creating a New Application

Create a basic Teams application:

```sh
teams new my-app
```

Create an application with a specific template:

```sh
teams new my-echo-app --template echo
```

Create and immediately start an application:

```sh
teams new my-quick-app --start
```

### Managing Environments

List all available environments:

```sh
teams env list
```

Select a specific environment:

```sh
teams env select production
```

Set environment variables:

```sh
teams env set CLIENT_ID "your-client-id" CLIENT_SECRET "your-client-secret"
```

### Configuring Applications

Add Teams Toolkit configuration:

```sh
teams config add ttk.local
```

Remove a configuration:

```sh
teams config remove ttk.local
```

## Advanced Examples

### Complete Project Setup

This example shows a complete workflow for setting up a new Teams application with authentication and Teams Toolkit integration:

```sh
# Create a new application with the AI template
teams new my-ai-assistant --template ai

# Navigate to the project directory
cd my-ai-assistant

# Add Teams Toolkit configuration for local development
teams config add ttk.local

# Set required environment variables
teams env set OPENAI_API_KEY "your-api-key"
teams env set OPENAI_MODEL "gpt-4"

# Start the application
npm run dev
```

### Multi-Environment Setup

This example demonstrates how to set up and manage multiple environments:

```sh
# Create a new application
teams new my-multi-env-app

# Navigate to the project directory
cd my-multi-env-app

# Set up development environment
teams env select dev
teams env set CLIENT_ID "dev-client-id"
teams env set CLIENT_SECRET "dev-client-secret"
teams env set ENDPOINT "https://dev.example.com"

# Set up production environment
teams env select prod
teams env set CLIENT_ID "prod-client-id"
teams env set CLIENT_SECRET "prod-client-secret"
teams env set ENDPOINT "https://prod.example.com"

# Switch back to development for local work
teams env select dev
```

### Creating a Tab Application

This example shows how to create a Teams tab application:

```sh
# Create a new tab application
teams new my-tab-app --template tab

# Navigate to the project directory
cd my-tab-app

# Add Teams Toolkit configuration
teams config add ttk.local

# Set required environment variables
teams env set TAB_APP_ID "your-app-id"
teams env set TAB_APP_URI "https://localhost:3000"

# Start the application
npm run dev
```

### Creating an AI Bot

This example demonstrates how to create an AI-powered bot:

```sh
# Create a new AI application
teams new my-ai-bot --template ai

# Navigate to the project directory
cd my-ai-bot

# Set required environment variables
teams env set OPENAI_API_KEY "your-api-key"
teams env set OPENAI_MODEL "gpt-4"
teams env set BOT_ID "your-bot-id"
teams env set BOT_PASSWORD "your-bot-password"

# Start the application
npm run dev
```

### Using Graph Integration

This example shows how to create an application with Microsoft Graph integration:

```sh
# Create a new Graph application
teams new my-graph-app --template graph --client-id "your-client-id" --client-secret "your-client-secret"

# Navigate to the project directory
cd my-graph-app

# Set additional environment variables
teams env set TENANT_ID "your-tenant-id"
teams env set GRAPH_SCOPES "User.Read,Calendars.Read"

# Start the application
npm run dev
```

### Creating an MCP Server

This example demonstrates how to create a Model Context Protocol server:

```sh
# Create a new MCP server
teams new my-mcp-server --template mcp

# Navigate to the project directory
cd my-mcp-server

# Set required environment variables
teams env set MCP_SERVER_PORT "3000"
teams env set MCP_SERVER_NAME "my-custom-mcp-server"

# Start the server
npm run dev
```

## Scripting Examples

### Creating a Project with npm Scripts

You can add Teams CLI commands to your npm scripts in `package.json`:

```json
{
  "scripts": {
    "create": "teams new my-app --template echo",
    "setup:dev": "teams env select dev && teams config add ttk.local",
    "setup:prod": "teams env select prod && teams config add ttk.prod",
    "start": "npm run setup:dev && npm run dev"
  }
}
```

Then run these scripts with npm:

```sh
npm run create
npm run setup:dev
npm run start
```

### Using with CI/CD Pipelines

You can use the Teams CLI in CI/CD pipelines to automate deployment:

```yaml
# Example GitHub Actions workflow
name: Deploy Teams App

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '20'
      
      - name: Install Teams CLI
        run: npm install -g @microsoft/teams.cli
      
      - name: Set environment variables
        run: |
          teams env select prod
          teams env set CLIENT_ID "${{ secrets.CLIENT_ID }}"
          teams env set CLIENT_SECRET "${{ secrets.CLIENT_SECRET }}"
      
      - name: Build and deploy
        run: |
          npm install
          npm run build
          npm run deploy
```

## Troubleshooting Examples

### Resetting Configuration

If you encounter issues with your configuration, you can reset it:

```sh
# Remove problematic configuration
teams config remove ttk.local

# Re-add the configuration
teams config add ttk.local
```

### Switching Environments

If your application is using the wrong environment variables:

```sh
# Check current environment
teams env list

# Switch to the correct environment
teams env select dev

# Verify environment variables
teams env export
```

## Next Steps

- [Explore the Teams Toolkit integration](../7.devtools/README.md)
- [Learn about authentication options](../3.basics/7.auth.md)
- [Discover AI capabilities](../8.ai/README.md)
