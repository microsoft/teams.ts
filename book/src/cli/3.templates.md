# Templates

The Teams CLI provides several project templates to help you get started quickly with different types of applications. This page describes each template in detail, including their features, use cases, and examples.

## Template Overview

When creating a new Teams application with the `teams new` command, you can specify a template using the `--template` option:

```sh
teams new my-app --template <template-name>
```

The following templates are available:

| Template | Description | Use Case |
| :------- | :---------- | :------- |
| `echo` | A simple echo bot that responds to messages | Getting started with bot development |
| `tab` | A Teams tab application with React | Building Teams tab experiences |
| `ai` | A bot with AI capabilities using Teams.AI | Creating intelligent conversational experiences |
| `graph` | An application with Microsoft Graph integration | Accessing Microsoft 365 data and services |
| `mcp` | A Model Context Protocol server template | Building custom MCP servers for AI integration |

## Template Details

### Echo Template

The Echo template creates a simple bot that echoes back any message it receives. It's a great starting point for learning the basics of Teams.TS and bot development.

#### Features

- Basic message handling
- Simple response logic
- Minimal dependencies
- Clear, commented code

#### Project Structure

```
my-echo-app/
├── .env
├── package.json
├── tsconfig.json
├── src/
│   └── index.ts
└── README.md
```

#### Example Usage

Create a new Echo bot:

```sh
teams new my-echo-bot --template echo
```

Start the bot:

```sh
cd my-echo-bot
npm install
npm run dev
```

#### Code Example

The main application logic in `src/index.ts` looks like this:

```typescript
import { App } from '@microsoft/teams.js';

// Create a new Teams application
const app = new App();

// Handle incoming messages
app.on('message', async ({ activity, send }) => {
  // Echo back the message text
  await send(`You said: ${activity.text}`);
});

// Start the application
app.start();
```

### Tab Template

The Tab template creates a Teams tab application using React. It's designed for building rich, interactive web experiences within Microsoft Teams.

#### Features

- React-based frontend
- Teams tab integration
- Hot module reloading for development
- TypeScript support

#### Project Structure

```
my-tab-app/
├── .env
├── package.json
├── tsconfig.json
├── vite.config.ts
├── src/
│   ├── index.ts          # Server-side entry point
│   └── client/           # Client-side React application
│       ├── index.tsx     # Client entry point
│       └── components/   # React components
└── README.md
```

#### Example Usage

Create a new Tab application:

```sh
teams new my-tab-app --template tab
```

Start the application:

```sh
cd my-tab-app
npm install
npm run dev
```

#### Code Example

The server-side code in `src/index.ts`:

```typescript
import { App } from '@microsoft/teams.js';
import path from 'path';

// Create a new Teams application
const app = new App();

// Serve the tab content
app.tab('test', path.resolve('dist/client'));

// Start the application
app.start();
```

### AI Template

The AI template creates a bot with AI capabilities using Teams.AI. It's designed for building intelligent conversational experiences.

#### Features

- Integration with AI models
- Conversational memory
- Streaming responses
- Prompt templates

#### Project Structure

```
my-ai-app/
├── .env
├── package.json
├── tsconfig.json
├── src/
│   ├── index.ts
│   ├── prompts/
│   │   └── system.txt
│   └── config.ts
└── README.md
```

#### Example Usage

Create a new AI bot:

```sh
teams new my-ai-bot --template ai
```

Start the bot:

```sh
cd my-ai-bot
npm install
npm run dev
```

#### Code Example

The main application logic in `src/index.ts`:

```typescript
import { App } from '@microsoft/teams.js';
import { OpenAI } from '@microsoft/teams.openai';
import { readFileSync } from 'fs';
import path from 'path';

// Create a new Teams application
const app = new App();

// Initialize OpenAI
const openai = new OpenAI();

// Load system prompt
const systemPrompt = readFileSync(path.join(__dirname, 'prompts', 'system.txt'), 'utf-8');

// Handle incoming messages
app.on('message', async ({ activity, send }) => {
  // Generate AI response
  const response = await openai.chat.completions.create({
    model: 'gpt-4',
    messages: [
      { role: 'system', content: systemPrompt },
      { role: 'user', content: activity.text }
    ]
  });
  
  // Send the response
  await send(response.choices[0].message.content);
});

// Start the application
app.start();
```

### Graph Template

The Graph template creates an application with Microsoft Graph integration. It's designed for accessing Microsoft 365 data and services.

#### Features

- Microsoft Graph API integration
- Authentication flow
- User profile access
- Calendar and email examples

#### Project Structure

```
my-graph-app/
├── .env
├── package.json
├── tsconfig.json
├── src/
│   ├── index.ts
│   ├── auth.ts
│   └── graph.ts
└── README.md
```

#### Example Usage

Create a new Graph application:

```sh
teams new my-graph-app --template graph --client-id "your-client-id" --client-secret "your-client-secret"
```

Start the application:

```sh
cd my-graph-app
npm install
npm run dev
```

#### Code Example

The Graph client setup in `src/graph.ts`:

```typescript
import { Graph } from '@microsoft/teams.graph';
import { getToken } from './auth';

// Create a Graph client
export const graph = new Graph({
  getToken: async () => {
    return await getToken();
  }
});

// Example: Get user profile
export async function getUserProfile() {
  return await graph.api('/me').get();
}

// Example: Get calendar events
export async function getCalendarEvents() {
  return await graph.api('/me/events').get();
}
```

### MCP Template

The MCP (Model Context Protocol) template creates a server that implements the Model Context Protocol. It's designed for building custom AI integrations.

#### Features

- MCP server implementation
- Tool and resource definitions
- API integration examples
- Extensible architecture

#### Project Structure

```
my-mcp-app/
├── .env
├── package.json
├── tsconfig.json
├── src/
│   ├── index.ts
│   ├── tools/
│   │   └── example.ts
│   └── resources/
│       └── example.ts
└── README.md
```

#### Example Usage

Create a new MCP server:

```sh
teams new my-mcp-server --template mcp
```

Start the server:

```sh
cd my-mcp-server
npm install
npm run dev
```

#### Code Example

The MCP server setup in `src/index.ts`:

```typescript
import { MCPServer } from '@microsoft/mcp';
import { exampleTool } from './tools/example';
import { exampleResource } from './resources/example';

// Create a new MCP server
const server = new MCPServer({
  name: 'example-server',
  description: 'An example MCP server',
  version: '1.0.0'
});

// Register tools
server.registerTool(exampleTool);

// Register resources
server.registerResource(exampleResource);

// Start the server
server.start();
```

## Custom Templates

You can also create your own custom templates by:

1. Creating a directory structure for your template
2. Adding it to the CLI's templates directory
3. Using it with the `--template` option

For more information on creating custom templates, see the [Contributing Guide](../9.contributing/1.documentation/README.md).

## Next Steps

- [Learn about environment management](./4.environments.md)
- [Configure your application](./5.configuration.md)
- [See common usage examples](./6.examples.md)
