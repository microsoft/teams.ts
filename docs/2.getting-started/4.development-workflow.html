<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Development Workflow - Teams SDK: Typescript</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "ayu";
            const default_dark_theme = "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Teams SDK: Typescript</h1>

                    <div class="right-buttons">
                        <a href="http://github.com/microsoft/teams.ts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="-development-workflow"><a class="header" href="#-development-workflow">ðŸ”„ Development Workflow</a></h1>
<p>This guide covers best practices for developing Teams AI SDK applications, including common development tasks, testing strategies, and deployment considerations.</p>
<h2 id="development-cycle"><a class="header" href="#development-cycle">Development Cycle</a></h2>
<p>A typical development workflow with Teams AI SDK follows these steps:</p>
<ol>
<li><strong>Plan</strong>: Determine what functionality you need to implement</li>
<li><strong>Code</strong>: Write the necessary code in your project</li>
<li><strong>Test</strong>: Run your application locally and test with DevTools</li>
<li><strong>Refine</strong>: Iterate based on testing results</li>
<li><strong>Deploy</strong>: Deploy your application to a production environment</li>
</ol>
<p>Let's explore each of these steps in more detail.</p>
<h2 id="common-development-tasks"><a class="header" href="#common-development-tasks">Common Development Tasks</a></h2>
<h3 id="adding-activity-handlers"><a class="header" href="#adding-activity-handlers">Adding Activity Handlers</a></h3>
<p>The most common task in Teams AI SDK development is adding handlers for different types of activities:</p>
<pre><code class="language-typescript">// Handle text messages
app.on('message', async ({ send, activity }) =&gt; {
  await send(`You said: "${activity.text}"`);
});

// Handle when users join the conversation
app.on('conversationUpdate', async ({ activity, send }) =&gt; {
  if (activity.membersAdded?.some(m =&gt; m.id !== activity.recipient?.id)) {
    await send('Welcome to the conversation!');
  }
});

// Handle specific events
app.on('event', async ({ activity, send }) =&gt; {
  if (activity.name === 'customEvent') {
    await send('Received a custom event!');
  }
});
</code></pre>
<h3 id="creating-adaptive-cards"><a class="header" href="#creating-adaptive-cards">Creating Adaptive Cards</a></h3>
<p>To create interactive experiences, you can use Adaptive Cards:</p>
<pre><code class="language-typescript">import { AdaptiveCard, TextBlock, ActionSet, SubmitAction } from '@microsoft/teams.cards';

app.on('message', async ({ send, activity }) =&gt; {
  if (activity.text === 'show card') {
    const card = new AdaptiveCard()
      .addItem(new TextBlock('Hello from Adaptive Card!').size('large'))
      .addItem(new ActionSet().addAction(
        new SubmitAction('Click Me').data({ action: 'buttonClicked' })
      ));
    
    await send({ attachments: [card] });
  }
});

// Handle card actions
app.on('invoke', async ({ activity, send }) =&gt; {
  if (activity.name === 'adaptiveCard/action') {
    const data = activity.value?.action?.data;
    if (data?.action === 'buttonClicked') {
      await send('You clicked the button!');
    }
  }
});
</code></pre>
<h3 id="adding-middleware"><a class="header" href="#adding-middleware">Adding Middleware</a></h3>
<p>Middleware allows you to process activities before they reach your handlers:</p>
<pre><code class="language-typescript">// Authentication middleware
app.use(async (context, next) =&gt; {
  // Check authentication
  if (!isAuthenticated(context.activity)) {
    await context.send('You are not authorized to use this bot.');
    return;
  }
  
  // Continue to next middleware or handler
  await next();
});

// Logging middleware
app.use(async (context, next) =&gt; {
  const start = Date.now();
  context.log.info(`Processing activity: ${context.activity.type}`);
  
  await next();
  
  const duration = Date.now() - start;
  context.log.info(`Processed activity in ${duration}ms`);
});
</code></pre>
<h3 id="integrating-with-external-services"><a class="header" href="#integrating-with-external-services">Integrating with External Services</a></h3>
<p>You can integrate with external services like databases or APIs:</p>
<pre><code class="language-typescript">import { MongoClient } from 'mongodb';

// Initialize database connection
const client = new MongoClient(process.env.MONGODB_URI || 'mongodb://localhost:27017');
let db: any;

(async () =&gt; {
  await client.connect();
  db = client.db('myBotDb');
  console.log('Connected to database');
})();

// Use database in handlers
app.on('message', async ({ send, activity }) =&gt; {
  if (activity.text === 'stats') {
    // Query database
    const stats = await db.collection('stats').findOne({ userId: activity.from?.id });
    
    await send(`Your stats: ${JSON.stringify(stats)}`);
  }
});
</code></pre>
<h2 id="testing-strategies"><a class="header" href="#testing-strategies">Testing Strategies</a></h2>
<h3 id="local-testing-with-devtools"><a class="header" href="#local-testing-with-devtools">Local Testing with DevTools</a></h3>
<p>As covered in the <a href="./3.running-your-app.html">Running Your App</a> guide, the integrated DevTools provide a powerful way to test your application locally.</p>
<h3 id="unit-testing"><a class="header" href="#unit-testing">Unit Testing</a></h3>
<p>For unit testing individual components, you can use Jest or another testing framework:</p>
<pre><code class="language-typescript">// handlers.ts
export function createMessageHandler() {
  return async ({ send, activity }: any) =&gt; {
    await send(`You said: "${activity.text}"`);
  };
}

// handlers.test.ts
import { createMessageHandler } from './handlers';

describe('Message Handler', () =&gt; {
  it('should echo back the message text', async () =&gt; {
    const mockSend = jest.fn();
    const mockContext = {
      send: mockSend,
      activity: { text: 'hello' }
    };
    
    const handler = createMessageHandler();
    await handler(mockContext);
    
    expect(mockSend).toHaveBeenCalledWith('You said: "hello"');
  });
});
</code></pre>
<h3 id="integration-testing"><a class="header" href="#integration-testing">Integration Testing</a></h3>
<p>For testing the entire application flow:</p>
<pre><code class="language-typescript">import { App } from '@microsoft/teams.apps';
import { createTestClient } from '@microsoft/teams.dev/testing';

describe('Bot Integration Tests', () =&gt; {
  let app: App;
  let testClient: any;
  
  beforeEach(() =&gt; {
    app = new App();
    app.on('message', async ({ send, activity }) =&gt; {
      await send(`You said: "${activity.text}"`);
    });
    
    testClient = createTestClient(app);
  });
  
  it('should respond to messages', async () =&gt; {
    const response = await testClient.sendMessage('hello');
    expect(response).toEqual('You said: "hello"');
  });
});
</code></pre>
<h2 id="using-turbo-for-monorepo-development"><a class="header" href="#using-turbo-for-monorepo-development">Using Turbo for Monorepo Development</a></h2>
<p>If you're developing multiple related applications or packages, you can use Turbo to manage a monorepo:</p>
<h3 id="setting-up-a-monorepo"><a class="header" href="#setting-up-a-monorepo">Setting Up a Monorepo</a></h3>
<ol>
<li>
<p>Create a root package.json:</p>
<pre><code class="language-json">{
  "name": "my-teams-apps",
  "private": true,
  "workspaces": ["apps/*", "packages/*"],
  "scripts": {
    "build": "turbo run build",
    "dev": "turbo run dev",
    "lint": "turbo run lint",
    "test": "turbo run test"
  },
  "devDependencies": {
    "turbo": "^1.10.0"
  }
}
</code></pre>
</li>
<li>
<p>Create a turbo.json configuration:</p>
<pre><code class="language-json">{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**"]
    },
    "dev": {
      "cache": false,
      "persistent": true
    },
    "lint": {},
    "test": {
      "dependsOn": ["build"]
    }
  }
}
</code></pre>
</li>
<li>
<p>Organize your projects:</p>
<pre><code>my-teams-apps/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ bot-app/
â”‚   â””â”€â”€ tab-app/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared-ui/
â”‚   â””â”€â”€ common-utils/
â”œâ”€â”€ package.json
â””â”€â”€ turbo.json
</code></pre>
</li>
</ol>
<h3 id="running-commands"><a class="header" href="#running-commands">Running Commands</a></h3>
<p>To run commands across all projects:</p>
<pre><code class="language-sh"># Build all projects
npm run build

# Run development servers for all projects
npm run dev

# Run tests for all projects
npm run test
</code></pre>
<p>To run commands for a specific project:</p>
<pre><code class="language-sh"># Run dev server for just the bot-app
npm run dev --workspace=apps/bot-app

# Build just the shared-ui package
npm run build --workspace=packages/shared-ui
</code></pre>
<h2 id="deployment-considerations"><a class="header" href="#deployment-considerations">Deployment Considerations</a></h2>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<p>For production deployment, ensure you have the correct environment variables set:</p>
<ol>
<li>Create a <code>.env.production</code> file with production values</li>
<li>Ensure sensitive values are not committed to source control</li>
<li>Configure your hosting platform with the necessary environment variables</li>
</ol>
<h3 id="hosting-options"><a class="header" href="#hosting-options">Hosting Options</a></h3>
<p>Teams AI SDK applications can be hosted on various platforms:</p>
<ul>
<li><strong>Azure App Service</strong>: Microsoft's recommended hosting for Teams applications</li>
<li><strong>Azure Functions</strong>: For serverless deployment</li>
<li><strong>Azure Container Apps</strong>: For containerized applications</li>
<li><strong>Other Cloud Providers</strong>: AWS, Google Cloud, etc.</li>
<li><strong>On-premises</strong>: Your own servers</li>
</ul>
<h3 id="deployment-process"><a class="header" href="#deployment-process">Deployment Process</a></h3>
<p>A typical deployment process includes:</p>
<ol>
<li>Build your application: <code>npm run build</code></li>
<li>Set up environment variables for production</li>
<li>Deploy the built application to your hosting platform</li>
<li>Register your bot/application with the Microsoft Teams platform</li>
<li>Test the deployed application in Teams</li>
</ol>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="follow-teamsts-principles"><a class="header" href="#follow-teamsts-principles">Follow Teams.TS Principles</a></h3>
<p>As outlined in the project's core principles:</p>
<ol>
<li><strong>Low Dependency</strong>: Minimize external dependencies to avoid compatibility issues</li>
<li><strong>Unopinionated Design</strong>: Use Teams AI SDK as a flexible toolkit, not a rigid framework</li>
<li><strong>Tool Consolidation</strong>: Leverage the integrated tools in the Teams AI SDK ecosystem</li>
</ol>
<h3 id="code-organization"><a class="header" href="#code-organization">Code Organization</a></h3>
<ul>
<li>Keep related functionality together</li>
<li>Use clear, descriptive names for files and functions</li>
<li>Separate business logic from activity handlers</li>
<li>Use TypeScript interfaces for complex data structures</li>
</ul>
<h3 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h3>
<p>Implement robust error handling:</p>
<pre><code class="language-typescript">app.on('message', async ({ send, activity, log }) =&gt; {
  try {
    // Potentially error-prone code
    const result = await someExternalService.process(activity.text);
    await send(`Result: ${result}`);
  } catch (error) {
    log.error('Error processing message:', error);
    await send('Sorry, I encountered an error processing your request.');
  }
});
</code></pre>
<h3 id="logging"><a class="header" href="#logging">Logging</a></h3>
<p>Use the built-in logging system with appropriate levels:</p>
<pre><code class="language-typescript">app.on('message', async ({ log, activity, send }) =&gt; {
  log.debug('Received message:', activity);
  log.info(`User ${activity.from?.name} sent: ${activity.text}`);
  
  if (someCondition) {
    log.warn('Unusual condition detected');
  }
  
  try {
    // Process message
  } catch (error) {
    log.error('Failed to process message:', error);
  }
});
</code></pre>
<h2 id="whats-next"><a class="header" href="#whats-next">What's Next?</a></h2>
<p>Now that you understand the development workflow:</p>
<ol>
<li><strong>Explore specific features</strong> like AI integration, Adaptive Cards, or authentication</li>
<li><strong>Build more complex applications</strong> by combining different Teams AI SDK packages</li>
<li><strong>Deploy your application</strong> to a production environment</li>
</ol>
<p>Check out the next guide on <a href="./5.next-steps.html">Next Steps</a> for guidance on where to go from here based on your specific needs.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../2.getting-started/3.running-your-app.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../2.getting-started/5.next-steps.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../2.getting-started/3.running-your-app.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../2.getting-started/5.next-steps.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
